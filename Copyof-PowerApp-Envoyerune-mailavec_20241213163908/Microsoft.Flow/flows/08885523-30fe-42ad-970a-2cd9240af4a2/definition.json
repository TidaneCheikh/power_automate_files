{"name":"c6f74963-df67-4d98-b3a4-5ac3baaed000","id":"/providers/Microsoft.Flow/flows/c6f74963-df67-4d98-b3a4-5ac3baaed000","type":"Microsoft.Flow/flows","properties":{"apiId":"/providers/Microsoft.PowerApps/apis/shared_logicflows","displayName":"Copy of - PowerApp -> Envoyer un e-mail avec des options","definition":{"metadata":{"workflowEntityId":null,"processAdvisorMetadata":null,"flowChargedByPaygo":null,"flowclientsuspensionreason":"None","flowclientsuspensiontime":null,"flowclientsuspensionreasondetails":null,"creator":{"id":"5c20a6cf-8ef3-4588-9f87-8fcf5fd5d476","type":"User","tenantId":"d852d5cd-724c-4128-8812-ffa5db3f8507"},"provisioningMethod":"FromDefinition","failureAlertSubscription":true,"clientLastModifiedTime":"2024-11-06T09:09:03.0535579Z","connectionKeySavedTimeKey":"2024-11-06T09:09:03.0535579Z"},"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","contentVersion":"1.0.0.0","parameters":{"$connections":{"defaultValue":{},"type":"Object"},"$authentication":{"defaultValue":{},"type":"SecureObject"}},"triggers":{"manual":{"metadata":{"operationMetadataId":"437ce69f-3c70-4119-a159-3fedcad764c3"},"type":"Request","kind":"PowerApp","inputs":{"schema":{"type":"object","properties":{"Mettreàjourl'élément_ID":{"type":"integer","format":"int64","description":"Identificateur unique d'un élément à modifier","x-ms-powerflows-param-ispartial":false},"Mettreàjourl'élément_ID_1":{"type":"integer"},"Mettreàjourl'élément_Titre":{"type":"string","x-ms-powerflows-param-ispartial":false},"Envoyerune-mailavecdesoptions_Corps":{"type":"string","description":"Corps du message","x-ms-powerflows-param-ispartial":false},"Envoyerune-mailavecdesoptions_Optionsutilisateur":{"type":"string","description":"Liste d'options séparées par des virgules pour la réponse par e-mail","x-ms-powerflows-param-ispartial":false},"Envoyerune-mailavecdesoptions_Optionsutilisateur_1":{"type":"string"},"Envoyerune-mailavecdesoptions_À":{"type":"string","format":"email","description":"Spécifiez les adresses de messagerie en les séparant par des points-virgules, par exemple, quelqu’un@contoso.com","x-ms-powerflows-param-ispartial":false}},"required":["Mettreàjourl'élément_ID","Mettreàjourl'élément_ID_1","Mettreàjourl'élément_Titre","Envoyerune-mailavecdesoptions_Corps","Envoyerune-mailavecdesoptions_Optionsutilisateur","Envoyerune-mailavecdesoptions_Optionsutilisateur_1","Envoyerune-mailavecdesoptions_À"]}}}},"actions":{"Envoyer_un_e-mail_avec_des_options":{"runAfter":{},"metadata":{"operationMetadataId":"3efa602d-6b3c-446d-9fec-2a9357be809a"},"type":"OpenApiConnectionWebhook","inputs":{"host":{"apiId":"/providers/Microsoft.PowerApps/apis/shared_office365","connectionName":"shared_office365","operationId":"SendMailWithOptions"},"parameters":{"optionsEmailSubscription/Message/To":"@triggerBody()['Envoyerune-mailavecdesoptions_À']","optionsEmailSubscription/Message/Subject":"Customer Feedback On Simulation Analysis","optionsEmailSubscription/Message/Options":"BAD,DISSATISFIED,GOOD,VERY_GOOD","optionsEmailSubscription/Message/Body":"@triggerBody()['Envoyerune-mailavecdesoptions_Corps']","optionsEmailSubscription/Message/Importance":"Normal","optionsEmailSubscription/Message/HideHTMLMessage":false,"optionsEmailSubscription/Message/ShowHTMLConfirmationDialog":false},"authentication":{"value":"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']","type":"Raw"}}},"Mettre_à_jour_l'élément":{"runAfter":{"Envoyer_un_e-mail_avec_des_options":["Succeeded"]},"metadata":{"operationMetadataId":"53c81f60-0504-440b-b4d5-e51b4c4cf036"},"type":"OpenApiConnection","inputs":{"host":{"apiId":"/providers/Microsoft.PowerApps/apis/shared_sharepointonline","connectionName":"shared_sharepointonline","operationId":"PatchItem"},"parameters":{"dataset":"https://shiftup.sharepoint.com/sites/BDRINCC","table":"5191f541-d2c8-4c9a-8214-4b42f0198202","id":"@triggerBody()['Mettreàjourl''élément_ID']","item/CustomerFeedback":"@if(equals(outputs('Envoyer_un_e-mail_avec_des_options')?['body/SelectedOption'],'BAD'),1,if(equals(outputs('Envoyer_un_e-mail_avec_des_options')?['body/SelectedOption'],'DISSATISFIED'),2,if(equals(outputs('Envoyer_un_e-mail_avec_des_options')?['body/SelectedOption'],'GOOD'),3,if(equals(outputs('Envoyer_un_e-mail_avec_des_options')?['body/SelectedOption'],'VERY_GOOD'),4,0))))"},"authentication":{"value":"@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']","type":"Raw"}}}}},"connectionReferences":{"shared_office365":{"connectionName":"a135192e572b43b7a1752bedb631b556","source":"Invoker","id":"/providers/Microsoft.PowerApps/apis/shared_office365","tier":"NotSpecified"},"shared_sharepointonline":{"connectionName":"3c4d2cda63d84bb498f01802b096eeee","source":"Invoker","id":"/providers/Microsoft.PowerApps/apis/shared_sharepointonline","tier":"NotSpecified"}},"flowFailureAlertSubscribed":false,"isManaged":false}}